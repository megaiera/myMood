// let myMood = [
//      {
//           "formations":
//                [
//                     {
//                          "name": "all",
//                          "id": 1,
//                          "totalStudents": null,
//                          "label": "Toutes les formations"
//                     },
//                     {
//                          "name": "back_end",
//                          "id": 2,
//                          "label": "back_end",
//                          "year": 2024,
//                          "totalStudents": 20,
//                          "averagemood": null,
//                          "students": [
//                               "student1",
//                               "student2",
//                               "student3",
//                               "student4",
//                               "student5"
//                          ]
//                     },
//                     {
//                          "name": "front_end",
//                          "id": 4,
//                          "label": "front_end",
//                          "year": 2024,
//                          "totalStudents": 21,
//                          "averagemood": null,
//                          "students": [
//                               "student1",
//                               "student2",
//                               "student3",
//                               "student4",
//                               "student5"
//                          ]

//                     },
//                     {
//                          "name": "cda",
//                          "id": 9,
//                          "label": "cda",
//                          "year": 2024,
//                          "totalStudents": 22,
//                          "averagemood": null,
//                          "students": [
//                               "student1",
//                               "student2",
//                               "student3",
//                               "student4",
//                               "student5"
//                          ]

//                     },
//                     {
//                          "name": "prepanum1",
//                          "id": 6,
//                          "label": "prépa numérique 1",
//                          "year": 2024,
//                          "totalStudents": 22,
//                          "averagemood": null,
//                          "students": [
//                               "student1",
//                               "student2",
//                               "student3",
//                               "student4",
//                               "student5"
//                          ]

//                     },
//                     {
//                          "name":"prepanum2",
//                          "label": "prépa numérique 2",
//                          "id": 8,
//                          "year": 2024,
//                          "totalStudents": 22,
//                          "averagemood": null,
//                          "students": [
//                               "student1",
//                               "student2",
//                               "student3",
//                               "student4",
//                               "student5"
//                          ]

//                     },
//                     {
//                          "name": "poa",
//                          "id": 3,
//                          "label": "poa",
//                          "year": 2024,
//                          "totalStudents": 22,
//                          "averagemood": null,
//                          "students": [
//                               "student1",
//                               "student2",
//                               "student3",
//                               "student4",
//                               "student5"
//                          ]

//                     }
//                ]
//      },

//      {
//           "stagiaires":
//                [
//                     {
//                          "id": 12,
//                          "name": "Clarisse",
//                          "surname": "Pestel",
//                          "mood": {
//                               "today": 50,
//                               "appel": false,
//                               "history": [
//                                    "12/01", "12/03", "12/07"
//                               ]
//                          },
//                          "formation": "front",
//                          "login": {
//                               "mdp": "abcef1234",
//                               "mail": "imts@institutsolacroup.com"
//                          }
//                     },
//                     {
//                          "id": 27,
//                          "name": "Thibaud",
//                          "surname": "Provost",
//                          "mood": {
//                               "today": 65,
//                               "appel": true,
//                               "history": [
//                                    "12/01", "12/03", "12/07"
//                               ]
//                          },
//                          "formation": "front",
//                          "login": {
//                               "mdp": "abcef1234",
//                               "mail": "imts@institutsolacroup.com"
//                          }
//                     },
//                     {
//                          "id": 14,
//                          "name": "Marine",
//                          "surname": "Le Cam",
//                          "mood": {
//                               "today": 55,
//                               "appel": false,
//                               "history": [
//                                    "12/01", "12/03", "12/07"
//                               ]
//                          },
//                          "formation": "front",
//                          "login": {
//                               "mdp": "abcef1234",
//                               "mail": "imts@institutsolacroup.com"
//                          }
//                     },
//                     {
//                          "id": 18,
//                          "name": "Cynthia",
//                          "surname": "Leclerc",
//                          "mood": {
//                               "today": 25,
//                               "appel": true,
//                               "history": [
//                                    "12/01", "12/03", "12/07"
//                               ]
//                          },
//                          "formation": "back",
//                          "login": {
//                               "mdp": "abcef1234",
//                               "mail": "imts@institutsolacroup.com"
//                          }
//                     },
//                     {
//                          "id": 38,
//                          "name": "Daniel",
//                          "surname": "Radcliff",
//                          "mood": {
//                               "today": 20,
//                               "appel": false,
//                               "history": [
//                                    "12/01", "12/03", "12/07"
//                               ]
//                          },
//                          "formation": "prepanum",
//                          "login": {
//                               "mdp": "abcef1234",
//                               "mail": "imts@institutsolacroup.com"
//                          }
//                     },
//                     {
//                          "id": 12,
//                          "name": "John",
//                          "surname": "Doe",
//                          "mood": {
//                               "today": 75,
//                               "appel": false,
//                               "history": [
//                                    "12/01", "12/03", "12/07"
//                               ]
//                          },
//                          "formation": "front",
//                          "login": {
//                               "mdp": "abcef1234",
//                               "mail": "imts@institutsolacroup.com"
//                          }
//                     },
//                     {
//                          "id": 27,
//                          "name": "John",
//                          "surname": "Doe",
//                          "mood": {
//                               "today": 50,
//                               "appel": false,
//                               "history": [
//                                    "12/01", "12/03", "12/07"
//                               ]
//                          },
//                          "formation": "front",
//                          "login": {
//                               "mdp": "abcef1234",
//                               "mail": "imts@institutsolacroup.com"
//                          }
//                     },
//                     {
//                          "id": 14,
//                          "name": "Jane",
//                          "surname": "Doe",
//                          "mood": {
//                               "today": 55,
//                               "appel": false,
//                               "history": [
//                                    "12/01", "12/03", "12/07"
//                               ]
//                          },
//                          "formation": "front",
//                          "login": {
//                               "mdp": "abcef1234",
//                               "mail": "imts@institutsolacroup.com"
//                          }
//                     },
//                     {
//                          "id": 18,
//                          "name": "Matt",
//                          "surname": "Smith",
//                          "mood": {
//                               "today": 25,
//                               "appel": false,
//                               "history": [
//                                    "12/01", "12/03", "12/07"
//                               ]
//                          },
//                          "formation": "back",
//                          "login": {
//                               "mdp": "abcef1234",
//                               "mail": "imts@institutsolacroup.com"
//                          }
//                     },
//                     {
//                          "id": 38,
//                          "name": "David",
//                          "surname": "Tennant",
//                          "mood": {
//                               "today": 10,
//                               "appel": false,
//                               "history": [
//                                    "12/01", "12/03", "12/07"
//                               ]
//                          },
//                          "formation": "prepanum",
//                          "login": {
//                               "mdp": "abcef1234",
//                               "mail": "imts@institutsolacroup.com"
//                          }
//                     },
//                     {
//                          "id": 12,
//                          "name": "John",
//                          "surname": "Doe",
//                          "mood": {
//                               "today": 75,
//                               "appel": false,
//                               "history": [
//                                    "12/01", "12/03", "12/07"
//                               ]
//                          },
//                          "formation": "front",
//                          "login": {
//                               "mdp": "abcef1234",
//                               "mail": "imts@institutsolacroup.com"
//                          }
//                     },
//                     {
//                          "id": 27,
//                          "name": "John",
//                          "surname": "Doe",
//                          "mood": {
//                               "today": 50,
//                               "appel": false,
//                               "history": [
//                                    "12/01", "12/03", "12/07"
//                               ]
//                          },
//                          "formation": "front",
//                          "login": {
//                               "mdp": "abcef1234",
//                               "mail": "imts@institutsolacroup.com"
//                          }
//                     }

//                ]
//      }
// ]


/* DOM */
let internsList = document.querySelector('#internsList');
let filtersList = document.querySelector('#filter_checkboxes');
const accessManage = document.getElementById('access-management');

/* ROUTES API */

const protocol="http://localhost:3000";
const adminRoot="/admin";
const endpointUsers="/users";


     let internsDataRequest=`${protocol}${adminRoot}${endpointUsers}`;
     let token="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImVtYWlsIjoiYWRtaW5AbXltb29kLmZyIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNzM4NzYxMTU0LCJleHAiOjE3Mzg4NDc1NTR9.FtkcP2TIuPj7wG-kJB9Cdu-Wz2XizXfOOFEdotv6NUw";
     let initParam={
          method:'GET',
          headers:{
               Accept:'application/json',
               Authorization: `Bearer ${token}`
          }}

     fetch(internsDataRequest, initParam)
          .then(response => response.json())
          .then(data=> showInternsData(data))
          .catch(error=>console.log(error));


/* GESTION > MENU CHECKBOX FILTERS */

const showInternsData=(data)=>{

for(let intern of data[0]){
     for (let intern of intern.groupe){

     let filterCheckbox = document.createElement('li');
     filterCheckbox.setAttribute('class', `${intern.groupe}`)
     filterCheckbox.innerHTML = `<input type="checkbox" class="filter ${intern.groupe}" id="${intern.groupe}" onclick="isChecked()">
                         <label for="${intern.groupe}"> ${intern.groupe}</label>`;
     filtersList.appendChild(filterCheckbox);

     function isChecked(){
          let checkbox = filtersList.querySelectorAll("input[type='checkbox']");
          if(checkbox.checked === true){
               console.log('checked')
          } else {
               console.log('not checked')
          }
     }
}}
}

     /* FONCTION SUPPRIMER FILTRE */

const deleteCourseBtn = document.getElementById('deleteFilterBtn');


/* FONCTION AJOUTER NOUVEAU FILTRE */ 

const addCourseFilterBtn=document.getElementById('addCoursePlusBtn');

function createNewCourse(){
     let input = document.getElementById('addCourseTextInput').value;
     if(input.length>=3){
     let newCourse=document.createElement('li');
     newCourse.innerHTML=`<input type="checkbox" name="filter" class="filter" id="${input}" value="${input}">
                         <label for="${input}"> ${input}</label>`;
     filtersList.appendChild(newCourse);

     myMood[0].formations.push({
          "name": input,
          "id": null,
          "label": input,
          "year": 2025,
          "totalStudents": null,
          "averagemood": null,
          "students": [
                    "student1",
                    "student2",
                    "student3",
                    "student4",
                    "student5"
                    ]

     });

     } else if(input.length<3){
          alert('Des caractères doivent être entrés')
     }
}

/* besoin du back pour le garder après page refresh (push()?) */


/* FONCTION CREATE NEW INTERN */
const formElement = document.getElementById('forms');

const getFormtoJSON = (form) => {
     return Object.fromEntries(new FormData(form).entries());
};

const handler = (e) => {
     e.preventDefault();
     const valid = formElement.reportValidity();
     if (valid) {
          const result = getFormtoJSON(formElement);
          console.log(result)
          myMood[1].stagiaires.push({
               "id": 88,
               "name": result.addName,
               "surname": result.addSurname,
               "mood": {
                    "today": 10,
                    "appel": false,
                    "history": [
                         "12/01", "12/03", "12/07"
                    ]
               },
               "formation": result.formations,
               "login": {
                    "mdp": "abcef1234",
                    "mail": result.addMail,
               }
          });
          updateInternsList();
     }
}

formElement.addEventListener("submit", handler);

updateInternsList();


/* GESTION > LISTE STAGIAIRES */
function updateInternsList() {
     internsList.replaceChildren();

const showInternsData=(data)=>{
     for (let stagiaire of data) {
          console.log(data)
          let internInfos = document.createElement('li');
          internInfos.setAttribute('class', `oneIntern ${stagiaire.formation}`);
          internsList.appendChild(internInfos);

          let internInfosName = document.createElement('span');
          internInfosName.setAttribute('class', 'liName infoLabel');
          internInfosName.innerHTML = `${stagiaire.name}`;
          internInfos.appendChild(internInfosName);

          let internInfosSurname = document.createElement('span');
          internInfosSurname.setAttribute('class', 'liSurname infoLabel');
          internInfosSurname.innerHTML = `${stagiaire.surname}`;
          internInfos.appendChild(internInfosSurname);

          let internInfosCourse = document.createElement('select');
          internInfosCourse.setAttribute('name', 'formations');
          internInfosCourse.setAttribute('class', 'liCourse infoLabel addIntern_selectCourse');

          internInfosCourse.innerHTML = `<option class="addIntern_option" value="frontend">Front End</option>
                              <option class="addIntern_option" value="backend">Back End</option>
                              <option class="addIntern_option" value="cda">CDA</option>
                              <option class="addIntern_option" value="prepnum1">Prépa Numérique 1</option>
                              <option class="addIntern_option" value="prepnum2">Prépa Numérique 2</option>
                              <option class="addIntern_option" value="poa">POA</option>`;
          internInfos.appendChild(internInfosCourse);

          let internInfosMail = document.createElement('span');
          internInfosMail.setAttribute('class', 'liMail infoLabel');
          internInfosMail.innerHTML = `${stagiaire.login.mail}`;
          internInfos.appendChild(internInfosMail);

          let internInfosCheckbox = document.createElement('INPUT');
          internInfosCheckbox.setAttribute('type', 'checkbox');
          internInfosCheckbox.setAttribute('value', 'delete');
          internInfos.appendChild(internInfosCheckbox);
     }
}}

